{% extends "base_generic.html" %}
{% load staticfiles range_tag account_tags %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'bootstrap/css/bootstrap.min.css' %}" />
{% endblock %}

{% block title %}Celebrity:  {{ celebrity.name }}{% endblock %}

{% block content %}
<div id="header-bar">
    <div id="header-bar-container"><h3>Tell us if {{ celebrity.name }} is a nice person or a douchebag.</h3></div>
</div>

<div class="celebrity-content">
    <div class="celebrity-content-top">
        <div class="celebrity-image celebrity-area">
            <img src="{{ celebrity.image1.url }}" width="200px" height="300px" alt="{{ celebrity.name }}" itemprop="image" class="pinterestImage" />
        </div>
        <div class="celebrity-block-right celebrity-block-border">
            <h1 class="celebrity-name"><span itemprop="name">{{ celebrity.name }}</span></h1>
            <div class="celebrity-box" >
                <div class="celebrity-inside-box rating-side">
                    <p class="rating-result-words" sub="hover">
                        {%if celebrity.average_rate >= 4.5 %}
                            <span>This celebrity is a douche bag</span>
                        {% elif celebrity.average_rate < 4.5 and celebrity.average_rate > 0 %}
                            <span>This celebrity is a nice person</span>
                        {% elif not celebrity.average_rate %}
                            <span>We have no information about this person</span>
                        {% endif %}
                    </p>
                    <div id="rating-numbers" class="rating-container" >
                        <a class="rating-box" style="display:block;" href="#contentReviews">
                            {% if celebrity.average_rate >= 4.5 %}
                                <img src="{% static 'images/celebritybad.png' %}" />
                            {% elif celebrity.average_rate < 4.5 and celebrity.average_rate > 0 %}
                                <img src="{% static 'images/celebritygood.png' %}" />
                            {% elif not celebrity.average_rate %}
                                <img src="{% static 'images/notyetrated.png' %}" />
                            {%endif%}
                            <span class="rate number">
                                {% if celebrity.average_rate %}{{ celebrity.average_rate|floatformat:1 }}{% else %}0.0{% endif %}
                            </span>
                        </a>
                        <div class="your-rating">
                            <div class="rating-stats">
                                Ratings Count: <span>{{ celebrity.rate_count }}</span>
                           </div>
                        </div>
                        {% if not my_rating %}
                        <div class="dbags-rating">
                            <div class="dbags-align">
                                <span style="width:100%;"></span>
                                <div id="rate" class="rating"></div>
                                {% if form.rate.errors %}
                                    <p>Please mark your rating here</p>
                                {% endif %}
                            </div>
                        </div>
                        {% endif %}
                        <p class="celebrity-known-for">
                           {{ celebrity.description }} 
                        </p>
                    </div>
                </div>
                <div class="clearfix"></div>
            </div>
            <div>
                <h4 class="header-message"><span class="fl">Must add a comment before submitting</span></h4>
            </div>
            <div class="rating-widget large-rating-widget media_block">
                <a href="" class="celebrity-image"> <img src="{{ user.get_profile.get_mugshot_url }}" width="50" sub="img" class="fl" alt=""></a>
                {% if my_rating %}
                    <p><b>You already rated this celebrity</b></p>
                    <div class="celebrity-block-right">
                        <div class="rating readonly" data-score="{{ my_rating.rate }}"></div>
                        <p>{{ my_rating.review }}</p>
                    </div>
                {% else %}
                    <form action="." method="post" id="form-celebrity-vote">
                        {% csrf_token %}
                        <input type="hidden" name="rate" id="rate_score" />
                        <div class="celebrity-block-right">
                            <div id="top_message">Make a comment before submitting your rating.</div>
                            <textarea id="review_text" class="review clearfix" placeholder="Add a Comment" name="review"></textarea>
                            {% if form.review.errors %}
                                <div class="errors">Please add your review</div>
                            {% endif %}
                                <div class="clearfix">
                                    <input class="button-rate"type="submit" value="Rate" />
                                </div>
                            <br/>
                        </div>
                    </form>
                {% endif %}
            </div>
            <!-- Go to your Addthis.com Dashboard to update any options -->
            <div class="addthis_sharing_toolbox float_right"></div>
        </div>
        <div class="quote_bubble top_critic fl cl">
            <span class="f1">All Comments</span>
            {% for rating in celebrity.rates.all %}
            <div class="review_quote_top"></div>
            <div class="review_quote">
                <div class="review_source media_block">
                    <img class="critic_thumb media_block_image" src="{{ rating.user.get_profile.get_mugshot_url }}">
                    <div class="media_block_content">
                        <div class="bold">
                            <p>{{ rating.user.get_full_name|default_if_empty:rating.user.username }}</p>
                        </div>
                    </div>
                </div>
                <div class="quote_contents media_block">
                    <div sub="hover" tip="Original Score: 2/4" class="media_block_image icon small rotten"></div>
                    <div class="media_block_content">
                        <div class="rating readonly" data-score="{{ rating.rate }}"></div>
                        <p>{{ rating.review }}</p>
                        <div class="small">
                            <span class="fr subtle">{{ rating.dt_updated }}</span>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}

        </div>
    </div>

    <div class="advertising-right">
        <img src="{% static 'images/CaptureGIF.GIF' %}" />
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script type="text/javascript" src="{% static 'raty/jquery.raty.min.js' %}"></script>
<script type="text/javascript" src="{% static 'bootstrap/js/bootstrap.min.js' %}"></script>
<script type="text/javascript" src="{% static 'js/rate.js' %}"></script>
{% endblock %}
