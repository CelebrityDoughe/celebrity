{% extends "base_generic.html" %}
{% load staticfiles range_tag %}

{% block title %}Celebrity{% endblock %}

{% block content %}
<div class="celebrity-content">
    <div class="celebrity-content-top">
        <div class="celebrity-image celebrity-area">
            <img src="{{ celebrity.image1.url }}" width="214px" height="317px" alt="{{ celebrity.name }}" itemprop="image" class="pinterestImage" />
        </div>
        <div class="celebrity-block-right celebrity-block-border">
            <h1 class="celebrity-name"><span itemprop="name">{{ celebrity.name }}</span></h1>
            <div class="celebrity-box" >
                <div class="celebrity-inside-box rating-side">
                    <p class="rating-result-words" sub="hover">
                        {%if rating_avg >= 4.5 %}
                            <span>This celebrity is a douche bag</span>
                        {% elif rating_avg < 4.5 and rating_avg > 0 %}
                            <span>This celebrity is a nice person</span>
                        {% elif rating_avg == 0 %}
                            <span>This celebrity has not yet benn rated.</span>
                        {% endif %}
                    </p>
                    <div id="rating-numbers" class="rating-container" >
                        {%if rating_avg >= 4.5%}
                        <img src="{% static 'images/celebritybad.png' %}" />
                        {% elif rating_avg < 4.5%}
                        <img src="{% static 'images/celebritygood.png' %}" />
                        {%endif%}
                        <a class="rating-box" style="display:block;" href="#contentReviews">
                            <span class="rate number">
                                {% if rating_avg %}{{ rating_avg|floatformat:1 }}{% else %}0.0{% endif %}
                            </span>
                        </a>
                        <div class="dbags-rating">
                            <div class="dbags-align">
                                <span style="width:100%;">
                                    <div class="rating">
                                        <span class="rater-starsOff" style="width: 220px; cursor: pointer;"> <span class="rater-starsOn" style="width: 63px; cursor: pointer;"></span> </span>
                                    </div> </span>
                            </div>
                            <p class="rating-stats">
                                Ratings Counted: <span>{{ rating_count }}</span>
                                <br>
                            </p>
                        </div>
                        <p class="celebrity-known-for">
                            {{ celebrity.get_specificity_display }} | {{ celebrity.description }}
                        </p>
                    </div>
                </div>
                <div class="clearfix"></div>
            </div>
            <div>
                <h4 class="header-message"><span class="fl">Rate if this celebrity is a dbag</span></h4>
            </div>
            <div class="rating-widget large-rating-widget media_block">
                <a href="" class="celebrity-image"> <img src="{{ user.get_profile.get_mugshot_url }}" width="50" sub="img" class="fl" alt=""> </a>
                {% if my_rating %}
                    <p><b>You already rated this celebrity</b></p>
                    <div class="celebrity-block-right">
                        <div class="rating readonly" data-score="{{ my_rating.rate }}"></div>
                        <p>{{ rating.review }}</p>
                    </div>
                {% else %}
                    <form action="." method="post" id="form-celebrity-vote">
                        {% csrf_token %}
                        <input type="hidden" name="rate" id="rate_score" />
                        <div class="celebrity-block-right">
                            <div id="rate" class="rating"></div>
                            {% if form.rate.errors %}
                                <p>Please mark your rating here</p>
                            {% endif %}
                            <br/>
                            <textarea id="review_text" class="review clearfix" placeholder="Add a Review" style="height: 38px;" name="review"></textarea>
                            {% if form.review.errors %}
                                <p>Please add your review</p>
                            {% endif %}
                                <div class="clearfix">
                                    <input class="button-short"type="submit" value="Rate" />
                                </div>
                            <br/>
                        </div>
                    </form>
                {% endif %}
            </div>

        </div>
        <div class="quote_bubble top_critic fl cl">
            <span class="f1"> Comments</span>

            {% for rating in celebrity.rates.all %}
            <div class="review_quote_top"></div>
            <div class="review_quote">
                <div class="review_source media_block">
                    <img class="critic_thumb media_block_image" src="{{ rating.user.get_profile.thumbnail }}">
                    <div class="media_block_content">
                        <div class="bold">
                            <p>{{ rating.user.get_full_name }}</p>
                        </div>
                    </div>
                </div>
                <div class="quote_contents media_block">
                    <div sub="hover" tip="Original Score: 2/4" class="media_block_image icon small rotten"></div>
                    <div class="media_block_content">
                        <div class="rating readonly" data-score="{{ rating.rate }}"></div>
                        <p>{{ rating.review }}</p>
                        <div class="small">
                            <span class="fr subtle">{{ rating.dt_updated }}</span>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}

        </div>
    </div>

    <div class="advertising-right">
        <img src="{% static 'images/CaptureGIF.GIF' %}" />
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script type="text/javascript" src="{% static 'raty/jquery.raty.min.js' %}"></script>
<script type="text/javascript" src="{% static 'js/rate.js' %}"></script>
{% endblock %}
