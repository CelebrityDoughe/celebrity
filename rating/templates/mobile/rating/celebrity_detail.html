{% extends "mobile/base_generic.html" %}
{% load staticfiles range_tag account_tags %}

{% block title %}Celebrity:  {{ celebrity.name }}{% endblock %}

{% block content %}

<div class="header-bar-mobile">
    <h3>Tell us if the celebrity you met is a nice person or a douchebag.</h3>
</div>
{% include "mobile/search_form.html" %}
<div class="celebrity-container-mobile">
    <div class="celeb-image-wrap"><img rc="{{ celebrity.image1.url }}">
    </div>
    <div class="celeb-name">
        <h1>{{ celebrity.name }}</h1>
    </div>
    <table id="result">
        <tbody>
            <tr>
                <td>
                <div class="result">
                    <span >
                        <p class="rating-result-words" sub="hover">
                            {%if celebrity.average_rate >= 4.5 %}
                            <span>This celebrity is a douche bag</span>
                            {% elif celebrity.average_rate < 4.5 and celebrity.average_rate > 0 %}
                            <span>This celebrity is a nice person</span>
                            {% elif not celebrity.average_rate %}
                            <span>This celebrity has not yet benn rated.</span>
                            {% endif %}
                        </p> </span>
                </div><span class="rate number"> {% if celebrity.average_rate %}{{ celebrity.average_rate|floatformat:1 }}{% else %}0.0{% endif %} </span></td><td class="ta-r">
                <div id="rating-numbers" class="rating-container" >
                    {% if celebrity.average_rate >= 4.5 %}
                    <img src="{% static 'images/celebritybad.png' %}" />
                    {% elif celebrity.average_rate < 4.5 and celebrity.average_rate > 0 %}
                    <img src="{% static 'images/celebritygood.png' %}" />
                    {%endif%}
                </div></td>
            </tr>
        </tbody>
    </table>
    <p class="celebrity-known-for">
        {{ celebrity.get_specificity_display }} | {{ celebrity.description }}
    </p>
    <div class="your-rating-mobile">
        {% if my_rating %}
        <div>Your Rating:</div>
        <div class="rating readonly" data-score="{{ my_rating.rate }}"></div><br />
        {% endif %}
    </div>
    <div class="rating-stats-mobile">
        Ratings Count: <span>{{ celebrity.rate_count }}</span>
    </div>

    {% if not my_rating %}
    <div class="dbags-rating">
        <div class="dbags-align">
            <span style="width:100%;">
                <div class="rating">
                </div>
            </span>
            {% if form.rate.errors %}
                <p>Please mark your rating here</p>
            {% endif %}
        </div>
    </div>
    {% endif %}
    <div class="rating-widget large-rating-widget media_block">
        <a href="" class="celebrity-image"> <img src="" sub="img" class="fl" alt="" width="50"></a>
        {% if my_rating %}
            <p><b>You already rated this celebrity</b></p>
            <div class="celebrity-block-right">
                <p>{{ my_rating.review }}</p>
            </div>
        {% else %}
        <form action="." method="post" id="form-celebrity-vote">
            {% csrf_token %}
            <input name="rate" id="rate_score" type="hidden">
            <div class="celebrity-block-right">
                <textarea id="review_text" class="review clearfix" placeholder="Add a Comment" style="height: 38px;" name="review"></textarea>

                <div class="clearfix">
                    <input class="button-rate" value="Rate" type="submit">
                </div>
                <br>
            </div>
        </form>
        {% endif %}

    </div>
    <div class="quote_bubble top_critic fl cl">
        <span class="f1"> Comments</span>

        {% for rating in celebrity.rates.all %}
        <div class="review_quote_top"></div>
        <div class="review_quote">
            <div class="review_source media_block">
                <img class="critic_thumb media_block_image" src="{{ rating.user.get_profile.get_mugshot_url }}">
                <div class="media_block_content">
                    <div class="bold">
                        <p>
                            {{ rating.user.get_full_name|default_if_empty:user.username }}
                        </p>
                    </div>
                </div>
            </div>
            <div class="quote_contents media_block">
                <div sub="hover" tip="Original Score: 2/4" class="media_block_image icon small rotten"></div>
                <div class="media_block_content">
                    <div class="rating readonly" data-score="{{ rating.rate }}"></div>
                    <p>
                        {{ rating.review }}
                    </p>
                    <div class="small">
                        <span class="fr subtle">{{ rating.dt_updated }}</span>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}

    </div>

</div><!--end celebrity-container-mobile-->
{% endblock %}

{% block extra_scripts %}
<script type="text/javascript" src="{% static 'raty/jquery.raty.min.js' %}"></script>
<script type="text/javascript" src="{% static 'bootstrap/js/bootstrap.min.js' %}"></script>
<script type="text/javascript" src="{% static 'js/rate.js' %}"></script>
{% endblock %}
